TODO

ğŸ“Œ 1. Core Components
- [ ] Set up main server (main.go) with HTTP router (chi, gorilla/mux, or net/http)
- [ ] Implement config loader (YAML/JSON for secrets, DB creds)
- [ ] Establish database connection (MySQL via gorm or database/sql)
- [ ] Create crypto utilities (ecdsa, rsa, ed25519, sha256)
- [ ] Integrate QR/barcode libraries (boombuler/barcode for QR, pdf417 lib)
- [ ] Add TOTP/seed generator (pquerna/otp)
- [ ] Implement JWT/session tokens (golang-jwt/jwt)
- [ ] Set up background workers (goroutines + timers for rotation)
- [ ] Add logging (zap or logrus)

ğŸ“Œ 2. Database Tables
- [ ] users: id, public_key, biometric_id, created_at
- [ ] sessions: id, user_id, active_key_set, expires_at
- [ ] qr_codes: id, session_id, outer_qr_payload, pdf417_payload, created_at, expires_at
- [ ] keys: id, session_id, seed_type, key_material, rotates_at
- [ ] certificates: id, creator_id, public_key, signature_algorithm
- [ ] audit_logs: id, action, user_id, timestamp

ğŸ“Œ 3. Endpoints (REST API)
ğŸ”‘ Auth & Identity
- [ ] POST /register â€“ register new user w/ passkey
- [ ] POST /login â€“ authenticate via passkey
- [ ] GET /me â€“ get current user

ğŸ“„ QR Management
- [ ] POST /qr/create â€“ generate QR (outer QR + PDF417 + inner matrices)
- [ ] GET /qr/:id â€“ retrieve QR metadata
- [ ] POST /qr/validate â€“ check scanned payload validity

ğŸ”„ Key Rotation
- [ ] POST /key/rotate â€“ force refresh session keys
- [ ] GET /key/status/:id â€“ current rotation state

ğŸ” Certificates
- [ ] POST /cert/register â€“ register creator certificate
- [ ] POST /cert/sign â€“ sign QR payload
- [ ] GET /cert/verify/:id â€“ verify QR signature

ğŸ›  Admin / Debug
- [ ] GET /health â€“ service check
- [ ] GET /stats â€“ system stats
- [ ] DELETE /session/:id â€“ invalidate session

ğŸ“Œ 4. Key & Seed System
- [ ] Implement Long Seed (per user, encrypted)
- [ ] Implement Short Seed (per session, fast-rotating)
- [ ] Implement MashSeed (derived from Long + Short, HKDF/PBKDF2)
- [ ] Implement TOTP Seed (time-based rolling codes)
- [ ] Implement Secret D / Secret K (session keys for QR encoding)
- [ ] Implement Certificate Key (creatorâ€™s signing key)

ğŸ“Œ 5. Go Packages (by folder)
/cmd/server/main.go
/internal/
   - [ ] auth/ â€“ login, passkeys, sessions
   - [ ] qr/ â€“ QR + PDF417 + DataMatrix generators
   - [ ] crypto/ â€“ keygen, TOTP, seeds, hashing
   - [ ] certs/ â€“ certificate handling, signatures
   - [ ] storage/ â€“ MySQL models + migrations
   - [ ] api/ â€“ HTTP handlers, routing
   - [ ] jobs/ â€“ key rotation workers
   - [ ] utils/ â€“ logging, config, helpers

ğŸ“Œ 6. Rotation Pipeline
- [ ] Issue session + seeds on login
- [ ] Generate outer QR with rotating PDF417
- [ ] PDF417 contains inner DataMatrix payloads (3 mini-IDs rotating every 3.333s, offset)
- [ ] Use seeds to drive rotations (TOTP, MashSeed, etc.)
- [ ] Validate scanned payloads via /qr/validate
- [ ] Optionally verify certificate signature

ğŸ“Œ 7. Developer Tools
- [ ] Dockerfile for deployment
- [ ] Makefile for builds/test
- [ ] Swagger/OpenAPI docs for API
- [ ] Unit tests (Go testing pkg)
- [ ] CI/CD (GitHub Actions)

